#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Executando verificaÃ§Ãµes de qualidade de cÃ³digo..."

# Laravel Pint
echo "ğŸ¨ Executando Laravel Pint..."
cd api
./vendor/bin/pint --test || {
    echo "âŒ Laravel Pint encontrou problemas. Corrigindo..."
    ./vendor/bin/pint
    git add .
}

# PHP-CS-Fixer
echo "ğŸ”§ Executando PHP-CS-Fixer..."
cd ..
infra/tools/php-cs-fixer fix api/ --dry-run --diff || {
    echo "âŒ PHP-CS-Fixer encontrou problemas. Corrigindo..."
    infra/tools/php-cs-fixer fix api/
    git add .
}

# PHPMD
echo "ğŸ“Š Executando PHPMD..."
infra/tools/phpmd api/app text cleancode,codesize,controversial,design,naming,unusedcode || {
    echo "âš ï¸ PHPMD encontrou problemas. Revise o cÃ³digo."
    exit 1
}

echo "âœ… VerificaÃ§Ãµes de qualidade concluÃ­das!"
